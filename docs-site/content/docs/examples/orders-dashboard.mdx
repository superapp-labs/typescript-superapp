---
title: Orders Dashboard
icon: ShoppingCart
description: Full page example with data table and queries.
---

A complete orders dashboard — backend permissions and a Next.js client page.

## Backend

```typescript title="engine.ts"
import { createEngine } from '@superapp/backend'

const engine = createEngine({
  connections: {
    main: { type: 'postgres', url: process.env.PG_URL! },
  },

  // Define what each permission can access
  permissions: {
    read_orders: {
      table: 'main.orders',
      operations: { select: true },
      columns: ['id', 'amount', 'status', 'customer_id', 'created_at'],
    },
    read_customers: {
      table: 'main.customers',
      operations: { select: true },
      columns: ['id', 'name', 'email'],
    },
  },

  // Assign permissions to roles
  roles: {
    viewer: ['read_orders', 'read_customers'],
    editor: ['read_orders', 'read_customers'],
    admin: ['read_orders', 'read_customers'],
  },
})
```

## Client

Types are inferred from Drizzle — no manual `interface` needed.

```tsx title="app/orders/page.tsx"
'use client'

import { useEffect, useState } from 'react'
import { useSession } from '@superapp/db/auth'
import { useDb } from '@/hooks/use-db'
import { ne, desc } from 'drizzle-orm'
import * as schema from '@/generated/schema'

// Type is inferred from the Drizzle schema
type Order = Awaited<
  ReturnType<ReturnType<typeof useDb>['query']['orders']['findMany']>
>[number]

export default function OrdersDashboard() {
  const { data: session, isPending } = useSession()
  const db = useDb()
  const [orders, setOrders] = useState<Order[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    if (!db) return
    setLoading(true)
    db.query.orders
      .findMany({
        with: { customer: true },
        where: ne(schema.orders.status, 'cancelled'),
        orderBy: desc(schema.orders.createdAt),
        limit: 50,
      })
      .then(setOrders)
      .finally(() => setLoading(false))
  }, [db])

  if (isPending) return <p>Loading session...</p>
  if (!session) return <p>Please sign in to view orders.</p>
  if (loading) return <p>Loading orders...</p>

  return (
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Customer</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {orders.map((order) => (
          <tr key={order.id}>
            <td>{order.id}</td>
            <td>{order.customer.name}</td>
            <td>${order.amount.toFixed(2)}</td>
            <td>{order.status}</td>
            <td>{new Date(order.created_at).toLocaleDateString()}</td>
          </tr>
        ))}
      </tbody>
    </table>
  )
}
```
